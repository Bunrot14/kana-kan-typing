<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <title>çµµæ–‡å­—ä½¿ç”¨ã«ãŠã‘ã‚‹æ„Ÿæƒ…ã‚¤ãƒ³ãƒ•ãƒ¬æŠ‘åˆ¶æ³•æ¡ˆ | ã‹ãªæ¼¢ã‚¿ã‚¤ãƒ”ãƒ³ã‚°</title>

  <link rel="canonical" href="https://www.typingwithclavier.com/problems/20250717_02.html">
  <!-- Google Fontsï¼ˆindexã¨åŒæ§‹æˆï¼‰ -->
  <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+JP&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=BIZ+UDMincho&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=BIZ+UDPMincho&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Rounded+Mplus+1c&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=BIZ+UDPGothic&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Zen+Kaku+Gothic+New&display=swap" rel="stylesheet">

  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>

  <!-- OGP -->
  <meta property="og:title" content="çµµæ–‡å­—ä½¿ç”¨ã«ãŠã‘ã‚‹æ„Ÿæƒ…ã‚¤ãƒ³ãƒ•ãƒ¬æŠ‘åˆ¶æ³•æ¡ˆ | ã‹ãªæ¼¢ã‚¿ã‚¤ãƒ”ãƒ³ã‚°" />
  <meta property="og:description" content="çµµæ–‡å­—ä½¿ç”¨ã«ãŠã‘ã‚‹æ„Ÿæƒ…è¡¨ç¾ã®éå‰°è£…é£¾åŠã³æ„å›³èª¤èªé˜²æ­¢æ³•æ¡ˆ ãƒ‡ã‚¸ã‚¿ãƒ«ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«ãŠã‘ã‚‹ç‰¹å®šã®çµµæ–‡å­—ã€ç‰¹ã«ã€Œå¬‰ã—æ³£ãï¼ˆğŸ˜‚ï¼‰ã€ã®éå‰°ä½¿ç”¨ãŒã€æœ¬æ¥ã®æ„Ÿæƒ…ä¾¡ã‚’è‘—ã—ãå¸Œè–„åŒ–ã•ã›ã€æ·±åˆ»ãªã€Œæ„Ÿæƒ…ã®ã‚¤ãƒ³ãƒ•ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã€ã‚’å¼•ãèµ·ã“ã—ã¦ã„ã‚‹ã€‚æœ¬æ³•æ¡ˆã¯ã€ã“ã®å•é¡Œã‚’æ˜¯æ­£ã—ã€å¥å…¨ãªæ„Ÿæƒ…è¡¨ç¾å¸‚å ´ã®å›å¾©ã‚’ç›®æŒ‡ã™ã‚‚ã®ã§ã‚ã‚‹ã€‚å…·ä½“ç­–ã¨ã—ã¦ã€åŒä¸€äººç‰©â€¦" />
  <meta property="og:image" content="https://www.typingwithclavier.com/assets/OGP_Clavier.png" />
  <meta property="og:url" content="https://www.typingwithclavier.com/problems/20250717_02.html" />
  <meta property="og:type" content="article" />

  <!-- Twitter -->
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:title" content="ã‹ãªæ¼¢ã‚¿ã‚¤ãƒ”ãƒ³ã‚°" />
  <meta name="twitter:description" content="æ–‡å­¦çš„ãªæ—¥æœ¬èªé•·æ–‡ã§å¿ƒã‚’æ•´ãˆã‚‹ã‚¿ã‚¤ãƒ”ãƒ³ã‚°ä½“é¨“ã‚’ã€‚" />
  <meta name="twitter:image" content="https://www.typingwithclavier.com/assets/OGP_Clavier.png" />

  <style>
    :root{
      --brand:#0b70c9;
      --brand2:#5aa0e8;
      --ink:#2c2f33;
      --paper:#ffffff;
      --ring:#93c5fd;
      --shadow: 0 6px 18px rgba(0,0,0,.08);
      --shadow-lg: 0 14px 26px rgba(0,0,0,.12);
      --btn-grad: linear-gradient(135deg, var(--brand), var(--brand2));
    }
    * { box-sizing: border-box; }
    html, body { margin: 0; padding: 0; }

    body {
      font-family: 'Yu Gothic', 'Noto Sans JP', system-ui, -apple-system, Segoe UI, Roboto, sans-serif;
      background: #f5f5f5;
      padding: 2rem;
      line-height: 1.8;
      color: var(--ink);
    }

    h1 { text-align: center; margin-bottom: 1rem; }

    /* index ã® display/textarea */
    #display, #typingArea, .row, .pager, footer, .link-row, .row-top-back {
      width: 65vw;
      margin-left: 0;
    }
    #display, #typingArea { border-radius: 12px; }
    #display {
      background-color: #EEF1F4;
      color: var(--ink);
      padding: 1rem;
      margin-bottom: 1rem;
      white-space: pre-wrap;
      overflow-wrap: break-word;
      word-break: break-word;
      min-height: 100px;
      border: 1px solid #d1d8e0;
      font-size: 0.945em;
    }
    .untyped  { color: var(--ink) !important; }
    .correct  { background-color: #d2e3f3 !important; color: #134684 !important; }
    .incorrect{ color: #cc3333 !important; background-color: #f6d8d8 !important; }

    #typingArea {
      min-height: 150px;
      max-height: 600px;
      overflow-y: auto;
      padding: 1rem;
      line-height: 1.5;
      resize: none;
      border: 1px solid #cbd5e1;
      font-family: inherit;
      font-size: 0.945em;
      background: var(--paper);
      box-shadow: var(--shadow);
    }

    /* è¡Œãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ */
    .row { display:flex; gap: 10px; align-items:center; margin-top: 10px; }
    .row-top-back { display:flex; justify-content:flex-start; align-items:center; margin: 8px 0 8px; }

    /* ãƒœã‚¿ãƒ³ï¼ˆåŸºåº•ï¼‰ */
    .btn {
      --bg: var(--paper);
      display:inline-flex; align-items:center; gap:.55rem;
      padding: .58rem 0.95rem;
      border-radius: 999px;
      border: 1px solid #cbd5e1;
      background: var(--bg);
      color: var(--brand);
      text-decoration:none;
      font-weight: 700;
      letter-spacing:.01em;
      box-shadow: var(--shadow);
      transition: transform .12s ease, box-shadow .2s ease, background-color .2s ease, border-color .2s ease, opacity .2s ease;
    }
    .btn:hover { transform: translateY(-1px); box-shadow: var(--shadow-lg); }
    .btn:focus-visible { outline: 3px solid var(--ring); outline-offset: 2px; }
    .btn svg { width: 1.05em; height: 1.05em; }

    /* å¼·å¼± */
    .btn.pill { border: none; color: white; background: var(--btn-grad); }
    .btn.ghost { color:#466; background: #fff; border: 1px dashed #cbd5e1; opacity:.9; }
    .btn.ghost:hover { opacity:1; }
    .btn.nav  { min-width: 9rem; justify-content:center; }

    /* 5ãƒªãƒ³ã‚¯ï¼ä¸‹éƒ¨ãƒªãƒ³ã‚¯ */
    .link-row { margin-top: 1rem; text-align: left; font-weight: bold; }
    .sep { margin: 0 0.5em; color: #555; }
    .archive-link { color: var(--brand); text-decoration: none; transition: all 0.2s ease; }
    .archive-link:hover { text-decoration: underline; transform: translateY(-1px); }

    /* æŒ‡å®šé€šã‚Šã® .criticism-link ãƒ‡ã‚¶ã‚¤ãƒ³ */
    .criticism-link {
      color: #009b00de;
      text-decoration: none;
      transition: all 0.3s ease;
    }
    .criticism-link:hover {
      color: #006b00;
      background-color: rgba(0, 155, 0, 0.1);
      border-radius: 4px;
      padding: 2px 4px;
      text-decoration: underline;
    }

    /* ãŠæ°—ã«å…¥ã‚Šãƒœã‚¿ãƒ³ï¼ˆå³ã«æµ®ã„ã¦ä»˜ã„ã¦ãã‚‹ï¼‰ */
    .favorite-button-fixed {
      position: absolute;
      display: flex;
      justify-content: flex-end;
      align-items: flex-end;
      pointer-events: none;
    }
    .favorite-button-fixed button {
      pointer-events: auto;
      font-size: 0.85em;
      padding: 6px 10px;
      border: 1px solid #aaa;
      background-color: #fffdf9;
      color: #555;
      border-radius: 8px;
      cursor: pointer;
      transition: background-color 0.2s ease, color 0.2s ease, box-shadow .2s ease;
      box-shadow: var(--shadow);
    }
    .favorite-button-fixed button:hover { background-color: #f0e6cc; color: #000; }
    .favorite-button-fixed button.active { background-color: #ffe08a; color: #000; border-color: #c9a634; }

    /* å‰å¾ŒãƒŠãƒ“ã®è¡Œ */
    .pager { display:flex; justify-content: space-between; align-items:center; margin-top: 14px; }

    footer { margin-top: 1.2rem; font-size: 12px; text-align: left; }

    /* ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ– */
    @media (max-width: 900px) {
      body { padding: 1rem !important; }
      #display, #typingArea, .row, .pager, footer, .link-row, .row-top-back { width: 98vw !important; max-width: 100vw !important; }
      #display, #typingArea { font-size: 1em !important; }
    }
    @media (max-width: 600px) {
      html, body { font-size: 15px !important; padding: 0.5rem !important; }
      #display, #typingArea { width: 99vw !important; padding: 0.7rem !important; font-size: 1em !important; }
      .row, .pager, .link-row, footer, .row-top-back { width: 99vw !important; }
    }
  </style>
</head>
<body>

  <!-- ã‚¿ã‚¤ãƒˆãƒ« -->
  <h1>çµµæ–‡å­—ä½¿ç”¨ã«ãŠã‘ã‚‹æ„Ÿæƒ…ã‚¤ãƒ³ãƒ•ãƒ¬æŠ‘åˆ¶æ³•æ¡ˆ</h1>

  <!-- ãƒˆãƒƒãƒ—ã¸æˆ»ã‚‹ï¼ˆå•é¡Œæ–‡æ¬„ã®ã™ãä¸Šãƒ»å·¦å¯„ã›ï¼‰-->
  <div class="row-top-back">
    <a class="btn back soft" href="https://www.typingwithclavier.com/index.html" aria-label="ãƒˆãƒƒãƒ—ãƒšãƒ¼ã‚¸ã¸æˆ»ã‚‹">
      <svg viewBox="0 0 24 24" aria-hidden="true"><path fill="currentColor" d="M10.6 4.6a1 1 0 0 1 1.4 0l7.4 7.4a1 1 0 0 1-1.4 1.4L12 7.4 6 13.4a1 1 0 1 1-1.4-1.4l6-6z"/><path fill="currentColor" d="M11 20a1 1 0 1 1 2 0v-9a1 1 0 1 1-2 0v9z"/></svg>
      <span>ãƒˆãƒƒãƒ—ãƒšãƒ¼ã‚¸ã¸æˆ»ã‚‹</span>
    </a>
  </div>

  <!-- æœ¬æ–‡ã‚½ãƒ¼ã‚¹ï¼ˆSEOã®ãŸã‚é™çš„åŸ‹ã‚è¾¼ã¿ï¼‰ -->
  <pre id="sourceText" class="visually-hidden" style="display:none">çµµæ–‡å­—ä½¿ç”¨ã«ãŠã‘ã‚‹æ„Ÿæƒ…è¡¨ç¾ã®éå‰°è£…é£¾åŠã³æ„å›³èª¤èªé˜²æ­¢æ³•æ¡ˆ
ãƒ‡ã‚¸ã‚¿ãƒ«ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«ãŠã‘ã‚‹ç‰¹å®šã®çµµæ–‡å­—ã€ç‰¹ã«ã€Œå¬‰ã—æ³£ãï¼ˆğŸ˜‚ï¼‰ã€ã®éå‰°ä½¿ç”¨ãŒã€æœ¬æ¥ã®æ„Ÿæƒ…ä¾¡ã‚’è‘—ã—ãå¸Œè–„åŒ–ã•ã›ã€æ·±åˆ»ãªã€Œæ„Ÿæƒ…ã®ã‚¤ãƒ³ãƒ•ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã€ã‚’å¼•ãèµ·ã“ã—ã¦ã„ã‚‹ã€‚æœ¬æ³•æ¡ˆã¯ã€ã“ã®å•é¡Œã‚’æ˜¯æ­£ã—ã€å¥å…¨ãªæ„Ÿæƒ…è¡¨ç¾å¸‚å ´ã®å›å¾©ã‚’ç›®æŒ‡ã™ã‚‚ã®ã§ã‚ã‚‹ã€‚å…·ä½“ç­–ã¨ã—ã¦ã€åŒä¸€äººç‰©ã«ã‚ˆã‚‹åŒä¸€çµµæ–‡å­—ã®é€£ç¶šä½¿ç”¨å›æ•°ã«ä¸Šé™ã‚’è¨­ã‘ã‚‹ã€Œçµµæ–‡å­—ä½¿ç”¨é‡åˆ¶é™ã€ã‚’å°å…¥ã™ã‚‹ã€‚ã¾ãŸã€ã‚ˆã‚Šç¹Šç´°ãªæ„Ÿæƒ…è¡¨ç¾ã‚’æ¶µé¤Šã™ã‚‹ãŸã‚ã€ã€Œç‰©æ†‚ã’ãªå¾®ç¬‘ã¿ï¼ˆğŸ˜Œï¼‰ã€ã‚„ã€Œé™ã‹ãªè«¦è¦³ï¼ˆğŸ˜‘ï¼‰ã€ã¨ã„ã£ãŸã€ä½¿ç”¨é »åº¦ã®ä½ã„çµµæ–‡å­—ã®ä½¿ç”¨ã«å¯¾ã—ã€é€šä¿¡æ–™é‡‘ã®å‰²å¼•ãªã©ã‚¤ãƒ³ã‚»ãƒ³ãƒ†ã‚£ãƒ–ã‚’ä¸ãˆã‚‹ã“ã¨ã‚‚æ¤œè¨ã•ã‚Œã¦ã„ã‚‹ã€‚ä¸€éƒ¨ã®è‹¥è€…å±¤ã‹ã‚‰ã¯ã€Œè¡¨ç¾ã®è‡ªç”±ã®ä¾µå®³ã ã€ã¨ã®åç™ºã‚‚äºˆæƒ³ã•ã‚Œã‚‹ãŒã€æ‹…å½“å¤§è‡£ã¯ã€Œå®‰æ˜“ãªã€ç¬‘ã€ã®ä¹±ç™ºãŒã€çœŸã®å–œã³ã®ä¾¡å€¤ã‚’æš´è½ã•ã›ã¦ã„ã‚‹ã®ã§ã™ã€ã¨è¿°ã¹ã€å›½æ°‘ã®ãƒ‡ã‚¸ã‚¿ãƒ«ãƒªãƒ†ãƒ©ã‚·ãƒ¼å‘ä¸Šã‚’å¼·ãä¿ƒã—ãŸã€‚</pre>

  <!-- è¡¨ç¤ºï¼†å…¥åŠ› -->
  <div id="display"></div>
  <textarea id="typingArea" placeholder="ã“ã“ã«å…¨æ–‡ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„..."></textarea>

  <!-- ãŠæ°—ã«å…¥ã‚Šï¼ˆå³å¯„ã›é…ç½®ï¼‰ -->
  <div class="favorite-button-fixed" id="favoriteButtonContainer">
    <button id="favoriteToggleButton">â˜† ãŠæ°—ã«å…¥ã‚Šã«è¿½åŠ </button>
  </div>

  <!-- 5ãƒªãƒ³ã‚¯ -->
  <div class="link-row">
    <a href="https://www.typingwithclavier.com/clavier_collection.html" class="archive-link">ã‚¯ãƒ©ãƒ´ã‚£ã‚¨ã®å¯“è©±é›†</a><span class="sep">ï½œ</span>
    <a href="https://www.typingwithclavier.com/archive.html" class="archive-link">ã™ã¹ã¦ã®ãƒãƒƒã‚¯ãƒŠãƒ³ãƒãƒ¼</a><span class="sep">ï½œ</span>
    <a href="https://www.typingwithclavier.com/Criticism_index.html" class="criticism-link">å•é¡Œæ–‡ã®è£åº­ï¼ˆè§£èª¬ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–ï¼‰</a><span class="sep">ï½œ</span>
    <a href="https://www.typingwithclavier.com/favorites.html" class="criticism-link">ãŠæ°—ã«å…¥ã‚Šãƒšãƒ¼ã‚¸</a><span class="sep">ï½œ</span>
    <a href="https://note.com/kanakantyping" class="criticism-link">note</a>
  </div>

  <div class="pager">
  
    <a class="btn pill nav" href="https://www.typingwithclavier.com/problems/20250717_01.html" aria-label="å‰ã®å•é¡Œ">
      <svg viewBox="0 0 24 24" aria-hidden="true"><path fill="currentColor" d="M15.5 5.5a1 1 0 0 1 0 1.4L11.4 11l4.1 4.1a1 1 0 1 1-1.4 1.4l-4.8-4.8a1 1 0 0 1 0-1.4l4.8-4.8a1 1 0 0 1 1.4 0z"/></svg>
      <span>å‰ã®å•é¡Œ</span>
    </a>
  

  <a class="btn ghost share" href="https://x.com/intent/post?text=%E7%B5%B5%E6%96%87%E5%AD%97%E4%BD%BF%E7%94%A8%E3%81%AB%E3%81%8A%E3%81%91%E3%82%8B%E6%84%9F%E6%83%85%E3%82%A4%E3%83%B3%E3%83%95%E3%83%AC%E6%8A%91%E5%88%B6%E6%B3%95%E6%A1%88%EF%BD%9C%E3%81%8B%E3%81%AA%E6%BC%A2%E3%82%BF%E3%82%A4%E3%83%94%E3%83%B3%E3%82%B0+%23%E3%81%8B%E3%81%AA%E6%BC%A2%E3%82%BF%E3%82%A4%E3%83%94%E3%83%B3%E3%82%B0&url=https%3A%2F%2Fwww.typingwithclavier.com%2Fproblems%2F20250717_02.html" target="_blank" rel="noopener" aria-label="Xã§ã‚·ã‚§ã‚¢">
    <svg viewBox="0 0 24 24" aria-hidden="true"><path fill="currentColor" d="M14.7 3h3.3l-4.6 5.3 5.4 7.7h-4.2l-3.3-4.4-3.8 4.4H4.2l5-5.7L4 3h4.3l3 4L14.7 3z"/></svg>
    <span>Xã§ã‚·ã‚§ã‚¢</span>
  </a>

  
    <a class="btn pill nav" href="https://www.typingwithclavier.com/problems/20250717_03.html" aria-label="æ¬¡ã®å•é¡Œ">
      <span>æ¬¡ã®å•é¡Œ</span>
      <svg viewBox="0 0 24 24" aria-hidden="true"><path fill="currentColor" d="M8.5 18.5a1 1 0 0 1 0-1.4L12.6 13 8.5 8.9a1 1 0 1 1 1.4-1.4l4.8 4.8a1 1 0 0 1 0 1.4l-4.8 4.8a1 1 0 0 1-1.4 0z"/></svg>
    </a>
  
</div>

  <!-- ä¸‹éƒ¨ãƒªãƒ³ã‚¯ -->
  <footer>
    <p style="margin: 0;">
      <a href="https://www.typingwithclavier.com/meditation_typing.html" class="archive-link">ç‘æƒ³çš„ã‚¿ã‚¤ãƒ”ãƒ³ã‚°ã®ã™ã™ã‚</a> |
      <a href="https://www.typingwithclavier.com/philosophy.html" class="archive-link">å•é¡Œæ–‡ã«è¾¼ã‚ãŸæƒ³ã„</a> |
      <a href="https://www.typingwithclavier.com/Misconversion.html" class="archive-link">èª¤å¤‰æ›ã®ãƒã‚¨ã‚¸ãƒ¼</a>
    </p>
  </footer>

  <!-- çµæœ -->
  <div id="popup">
    <ul id="popupList"></ul>
    
  </div>

<script>
(function(){
  const display = document.getElementById("display");
  const typingArea = document.getElementById("typingArea");
  const popup = document.getElementById("popup");
  const popupList = document.getElementById("popupList");
  const sourceTextEl = document.getElementById("sourceText");
  const favoriteBtn = document.getElementById("favoriteToggleButton");

  const pageMeta = {
    url: "https://www.typingwithclavier.com/problems/20250717_02.html",
    title: "çµµæ–‡å­—ä½¿ç”¨ã«ãŠã‘ã‚‹æ„Ÿæƒ…ã‚¤ãƒ³ãƒ•ãƒ¬æŠ‘åˆ¶æ³•æ¡ˆ",
    date: "2025-07-17",
    tags: ["æ”¿æ²»"],
  };

  const currentEssayText = (sourceTextEl ? sourceTextEl.textContent : "").replace(/\\r\\n|\\r/g, "\\n");
  let startTime = null;

  function updateDisplay() {
    const input = typingArea.value || "";
    display.innerHTML = "";
    let errorMarked = false;

    for (let i = 0; i < currentEssayText.length; i++) {
      const span = document.createElement("span");
      const expected = currentEssayText[i];
      const typed = input[i];

      if (i < input.length) {
        if (!errorMarked) {
          span.className = (typed === expected) ? "correct" : "incorrect";
          if (typed !== expected) errorMarked = true;
        } else {
          span.className = "untyped";
        }
      } else {
        span.className = "untyped";
      }
      span.textContent = expected;
      display.appendChild(span);
    }

    if (!errorMarked && input === currentEssayText && currentEssayText.length > 0) {
      showResult();
    }
  }

  function getEvalMsg(wpm){
    if (wpm >= 350) return "You are Clavier.";
    if (wpm >= 250) return "ã‚ãªãŸã¯éµã‚’ã‚‚ã¤é¢¨ã€‚";
    if (wpm >= 200) return "ã‚ãªãŸã®è¨€è‘‰ã¯ç¨²å¦»ã€‚ä¸–ç•Œã‚’è²«ã„ã¦ã„ã‚‹ã€‚";
    if (wpm >= 120) return "æ€è€ƒã¨æŒ‡å…ˆãŒèª¿å’Œã—ã¦ã€ç¾ã—ã„æ—‹å¾‹ã‚’å¥ã§ã¦ã„ã‚‹ã€‚";
    if (wpm >= 60)  return "ç¢ºã‹ãªæ­©ã¿ãŒã€è¨€è‘‰ã‚’ã²ã¨ã¤ãšã¤ç´¡ã„ã§ã„ãã€‚";
    if (wpm >= 30)  return "æ€¥ãŒãšç„¦ã‚‰ãšã€è¨€è‘‰ã¨å¿ƒã‚’çµã³ã¤ã‘ã‚‹æ—…ã®é€”ä¸­ã€‚";
    return "è¤‡é›‘ã«è€ƒãˆãšã€è‡ªåˆ†è‡ªèº«ã§ã„ã‚‹ã“ã¨ã€‚";
  }
  function getLevelComment(wpm){
    if (wpm >= 350) return "ç¥é€Ÿã®é ˜åŸŸã€‚æŒ‡å…ˆã§è©©ã‚’æ›¸ã„ã¦ã„ã‚‹ã‚ˆã†ã§ã™ã€‚";
    if (wpm >= 250) return "ãƒ—ãƒ­ãƒ•ã‚§ãƒƒã‚·ãƒ§ãƒŠãƒ«ã®é¢¨æ ¼ã€‚ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ã‚‚ã‚ãªãŸã«å¾“ã£ã¦ã„ã‚‹ã€‚";
    if (wpm >= 200) return "æ´—ç·´ã•ã‚ŒãŸé€Ÿåº¦ã€‚ã‚¿ã‚¤ãƒ”ãƒ³ã‚°ãŒæ—¥å¸¸ã®ä¸€éƒ¨ã¨ãªã£ã¦ã„ã‚‹è¨¼ã§ã™ã€‚";
    if (wpm >= 120) return "å®Ÿå‹™ã§ã‚‚ååˆ†é€šç”¨ã—ã¾ã™ã€‚æ»‘ã‚‰ã‹ãªè¨€è‘‰ã®æµã‚ŒãŒæ„Ÿã˜ã‚‰ã‚Œã¾ã™ã€‚";
    if (wpm >= 60)  return "è½ã¡ç€ã„ãŸãƒ†ãƒ³ãƒã€‚ç€å®ŸãªåŠ›ã‚’è‚²ã‚“ã§ã„ã¾ã™ã€‚";
    if (wpm >= 30)  return "ä¸å¯§ã•ãŒå…‰ã£ã¦ã„ã¾ã™ã€‚æ­£ç¢ºã•ã¯åŠ›ã§ã™ã€‚";
    return "å§‹ã¾ã‚Šã®ä¸€æ­©ã€‚ç„¦ã‚‰ãšã€æ¥½ã—ã¿ãªãŒã‚‰è‚²ã¦ã¦ã„ãã¾ã—ã‚‡ã†ã€‚";
  }

  function showResult(){
    if (!startTime) return;
    const elapsed = ((Date.now() - startTime) / 1000);
    const charCount = typingArea.value.length;
    const wpm = (charCount > 0 && elapsed > 0) ? Math.round((charCount / elapsed) * 60) : 0;

    popupList.innerHTML = "";
    const mk = (label, content)=>{
      const li = document.createElement("li");
      li.style.whiteSpace = "nowrap"; li.style.overflow = "hidden"; li.style.textOverflow="ellipsis";
      li.innerHTML = "<strong>"+label+"</strong> "+content;
      return li;
    };
    popupList.appendChild(mk("æ‰€è¦æ™‚é–“ï¼š", elapsed.toFixed(1)+"ç§’"));
    popupList.appendChild(mk("å…¥åŠ›æ–‡å­—æ•°ï¼š", charCount+"æ–‡å­—"));
    popupList.appendChild(mk("WPMï¼š", wpm+"æ–‡å­—/åˆ†ã€€"+getLevelComment(wpm)));
    popupList.appendChild(mk("è©•ä¾¡ï¼š", getEvalMsg(wpm)));

    popup.style.display = "block";
    typingArea.blur();
  }

  // å…¥åŠ›ã‚¤ãƒ™ãƒ³ãƒˆï¼ãƒšãƒ¼ã‚¹ãƒˆç„¡åŠ¹ï¼Qã‚­ãƒ¼ã§é–‰ã˜ã‚‹
  typingArea.addEventListener("input", ()=>{
    if (!startTime && typingArea.value.length > 0) startTime = Date.now();
    if (typingArea.value.length === 0) startTime = null;
    updateDisplay();
  });
  typingArea.addEventListener("paste", (e)=>{ e.preventDefault(); alert("ãƒšãƒ¼ã‚¹ãƒˆã¯ç„¡åŠ¹ã§ã™ã€‚"); });
  document.addEventListener("keydown", (e)=>{
    if ((e.key === "q" || e.key === "Q") && popup.style.display === "block") {
      popup.style.display = "none";
      typingArea.focus();
      e.preventDefault();
    }
  });

  // ===== ãŠæ°—ã«å…¥ã‚Šï¼ˆfavoriteProblemsï¼‰ =====
  function loadFavorites(){ try { return JSON.parse(localStorage.getItem('favoriteProblems') || '[]'); } catch(_) { return []; } }
  function saveFavorites(list){ localStorage.setItem('favoriteProblems', JSON.stringify(list)); }
  function isFavorited(url){ return loadFavorites().some(f => f.url === url); }
  function toggleFavorite(){
    const favs = loadFavorites();
    const i = favs.findIndex(f=>f.url===pageMeta.url);
    if (i>=0){ favs.splice(i,1); saveFavorites(favs); updateFavBtn(false); return; }
    favs.push({url:pageMeta.url, title:pageMeta.title, date:pageMeta.date, text:currentEssayText, tags:pageMeta.tags||[], setIndex:null, essayIndexInSet:null});
    saveFavorites(favs); updateFavBtn(true);
  }
  function updateFavBtn(active){
    favoriteBtn.classList.toggle('active', !!active);
    favoriteBtn.textContent = active ? "â˜… ãŠæ°—ã«å…¥ã‚Šã«ç™»éŒ²æ¸ˆã¿" : "â˜† ãŠæ°—ã«å…¥ã‚Šã«è¿½åŠ ";
  }
  function initFavorite(){
    if (!favoriteBtn) return;
    updateFavBtn(isFavorited(pageMeta.url));
    favoriteBtn.addEventListener('click', toggleFavorite);
  }

  // ãŠæ°—ã«å…¥ã‚Šãƒœã‚¿ãƒ³ã®ä½ç½®èª¿æ•´
  function positionFavoriteButton() {
    const typingRect = typingArea.getBoundingClientRect();
    const fav = document.getElementById('favoriteButtonContainer');
    if (!fav) return;
    fav.style.top  = (window.scrollY + typingRect.bottom - 32) + "px";
    fav.style.left = (window.scrollX + typingRect.right + 8) + "px";
  }
  window.addEventListener('load', positionFavoriteButton);
  window.addEventListener('resize', positionFavoriteButton);
  window.addEventListener('scroll', positionFavoriteButton);

  // åˆæœŸåŒ–
  updateDisplay();
  initFavorite();
})();
</script>
</body>
</html>